<html>
   <head>
      <meta charset="utf-8"/>
      <script src="wasm_exec.js"></script>
   </head>
   <body>
      <form >
	      <textarea id="koko" name="koko" style="width:60%; height: 60%;"></textarea>
      </form>
      <button onclick="makeOutputRun()">Go koko nuts!</button>
      <br/>
      <br/>
      Koko's nutty output:
      <div id="output" style="font-family: Courier New;background-color: black; color: antiquewhite;width: 60%;"> &nbsp; </div>
      <br>
      <div style="width:60%">
         <b>What is Koko?</b> </br><a href="https://github.com/jemmaissroff/koko">Koko</a> is a toy programming language developed
         by <a href="https://jemma.dev/">Jemma Issroff</a> during the Fall 2 Batch of the <a href="https://www.recurse.com/">Recurse Center</a>.
         <a href="https://www.peterstefek.me/">Peter Stefek</a>  also added a few features later on in development.
         Koko is based off of the <a href="https://monkeylang.org/">Monkey Programming Language</a>.
         All Monkey programs are valid Koko. This language is still in development and there are likely undiscovered bugs. If you find one
         feel free to file a <a href="https://github.com/jemmaissroff/koko/issues">github issue</a>!
      </div>
      <script type="text/javascript">
         const queryString = window.location.search;
         const urlParams = new URLSearchParams(queryString);
         const program = urlParams.get('program') || '// Try write some Koko...';
         document.getElementById('koko').innerHTML = program

         const importObj = {
            module: {}
         };
         const go = new Go();
         async function fetchAndInstantiate() {
            const response = await fetch("main.wasm");
            const buffer = await response.arrayBuffer();
            const obj = await WebAssembly.instantiate(buffer, go.importObject);
            console.log(obj);
            go.run(obj.instance);
         }
         fetchAndInstantiate();

         function makeOutputRun() {
            newAddress = encodeURIComponent(document.getElementById('koko').value);
            window.history.pushState("", "konsole", "?program=" + newAddress);
            executeProgram(document.getElementById('koko').value);
            document.getElementById('output').innerHTML = output
         }
      </script>
   </body>
</html>
